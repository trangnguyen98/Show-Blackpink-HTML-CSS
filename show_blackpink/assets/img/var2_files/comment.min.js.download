$.UseCommentModule=function(n){function k(t){var e=0,o=0,a=function(n){var i=document.body.contains(n[0]),r,t,f;return i||(n.hide(),u.append(n)),r=n.CommentContent.height(),t=n.clone(),t.CommentContent=t.find(".comment-main > .comment-content").last(),t.CommentContent.height("auto"),t.hide(),u.append(t),f=t.CommentContent.height()>r,t.remove(),i||(n.remove(),n.show()),f},v=function(){var i="cl-icon-thumbs-up-1",r="cl-icon-thumbs-down-1",u,e;t.IsUserVoteLikePost==1&&t.TotalLikePost>0?(i="cl-icon-thumbs-up-full",r="cl-icon-thumbs-down-1"):t.IsUserVoteLikePost==0&&t.TotalDisLikePost>0?(i="cl-icon-thumbs-up-1",r="cl-icon-thumbs-down-full"):(i="cl-icon-thumbs-up-1",r="cl-icon-thumbs-down-1");u='<span class="likeButton"><i class = "'+i+' up" id="img_'+t.CommentId+'"/> <span id="countVoteLike_'+t.CommentId+'" class = "count-vote"> '+t.TotalLikePost+'<\/span><\/span><span class="disLikeButton"><i class = "'+r+' down" id="imgDisLike_'+t.CommentId+'"/><span id="countVoteDisLike_'+t.CommentId+'" class = "count-vote"> '+t.TotalDisLikePost+"<\/span> <\/span>";e='<span class="footer-button reply-button"><i class="cl-icon-reply-full reply-img"><\/i>'+translate.instant("COMMENTS_ACTION_LABEL_REPLY")+"<\/span>";u='<div class="user-action-buttons">'+u+e+"<\/div>";var w=t.HasReplies&&!t.TopLevelCommentId?'<span class="footer-button toggle-replies">View replies<\/span>':"",s=t.CanHideComment?'<span class="footer-button hide-button">'+translate.instant("COMMENTS_ACTION_LABEL_HIDE")+"<\/span>":"",h=t.CanEditComment?'<span class="footer-button edit-button">'+translate.instant("SYSTEM_ACTIONS_LABEL_EDIT")+"<\/span>":"",c=t.CanDeleteComment?'<span class="footer-button delete-button">'+translate.instant("SYSTEM_ACTIONS_LABEL_DELETE")+"<\/span>":"",l=[u,s,h,c,].filter(function(n){return n&&tt}).join(wt),a=t.Comment,f=t.Replies&&t.Replies.length>0?t.Replies[0]:null,v=f==null||t.TotalRepliesCount<2?"":"<div class='first-reply'><div class='user-avatar'><div class='avatars'><img class='level-avatar' src='"+s3Storage+f.UserExpLevel.IconUrl+"'/> <img src='"+s3Storage+f.CreatorAvatarUrl+"' /><\/div><\/div >                         <div class='comment-info'><div class='comment-user'> "+f.Creator+"<\/div>                    <span> "+translate.instant("COMMENTS_ACTION_LABEL_REPLIED")+"<\/span> "+wt+" <span class='expand-replies'> <span class='total-replies'>"+t.TotalRepliesCount+"<\/span> "+translate.instant("COMMENTS_ACTION_LABEL_REPLIES")+"<\/span ><\/div ><\/div> ",y=t.HasReplies?"comment-block has-replies":"comment-block",p=ri+t.CreatorId,o='<div class="'+y+'">                       <div class="user-avatar">                         <div class="avatars">                             <img class="level-avatar" src="'+s3Storage+t.UserExpLevel.IconUrl+'"/>                             <img src="'+s3Storage+t.CreatorAvatarUrl+'" />                         <\/div>                       <\/div>                       <div class="comment-main">                         <div class="comment-user"><a href="'+p+'" class = "href-user">'+t.Creator+'<\/a> <span class="modified-time">'+ei(new Date(t.CreatedUtcTimeInSeconds*1e3))+'<\/span><\/div>                        <div class="comment-content">'+a+'<\/div>                         <div class="comment-message for-edit"><\/div>                         <div class="view-more">'+translate.instant("SYSTEM_ACTIONS_LABEL_VIEW_MORE")+'<\/div>                         <div class="comment-footer">                           <div class="left-parts action-buttons"><span class="hide-message">'+translate.instant("COMMENTS_MESSAGE_HIDDEN")+" <\/span>"+l+'<\/div>                           <div class="right-parts"><button class="btn btn-success standard-button save-button">'+translate.instant("SYSTEM_ACTIONS_LABEL_SAVE")+'<\/button>                          <\/div>                         <\/div>                         <div class="replies">'+v+'<\/div>                         <div class="edit-box reply-box hide">                           <div placeholder="'+translate.instant("COMMENTS_PLACEHOLDER_WRITE")+'" class="with-placeholder" id="comment-box" contenteditable><\/div>                           <div class="waiting-indicator"><span class="glyphicon glyphicon-refresh"><\/span><\/div>';return n.showReply||(o+='<a href="#" class="submit-cmmt btn" title="'+translate.instant("COMMENTS_ACTION_LABEL_COMMENT")+'" > '+translate.instant("COMMENTS_ACTION_LABEL_COMMENT")+"<\/a >"),o+'<\/div>                         <div class="comment-message"><\/div>                       <\/div>                     <\/div>'},i=$(v()),l,c;return i.RepliedCommentContent=i.find(".comment-main > .reply-box > .with-placeholder").last(),i.CommentContent=i.find(".comment-main > .comment-content").last(),i.ReplyBox=i.find(".comment-main > .reply-box").last(),i.PostReplyButton=i.find(".comment-main > .reply-box .submit-cmmt").last(),i.RepliesContainer=i.find(".comment-main > .replies").last(),i.HideButton=i.find(".comment-main > .comment-footer > .left-parts .hide-button").last(),i.EditButton=i.find(".comment-main > .comment-footer > .left-parts  .edit-button").last(),i.DeleteButton=i.find(".comment-main > .comment-footer > .left-parts .delete-button").last(),i.ReplyButton=i.find(".comment-main > .comment-footer > .left-parts .reply-button").last(),i.ExpandMoreRepliesButton=i.find(".comment-main > .replies > .first-reply .expand-replies").last(),i.LikeButton=i.find(".comment-main > .comment-footer > .left-parts  .likeButton").last(),i.DisLikeButton=i.find(".comment-main > .comment-footer > .left-parts .disLikeButton").last(),i.checkAndUpdateOverflownStatus=function(){var n=a(i);i.CommentContent.toggleClass("overflown",n)},i.checkAndUpdateOverflownStatus(),i.SaveButton=i.find(".comment-main > .comment-footer > .right-parts > .save-button").last(),i.SaveButton.hide(),i.ReplyBox.Editor=i.RepliedCommentContent,i.RepliedCommentContent.View=i,i.ViewMoreRepliesButton=$("<div class='view-more-comments-button as-link'><span class='view-more-text'>"+translate.instant("COMMENTS_LABEL_VIEW_MORE")+"<\/span><span class='glyphicon glyphicon-refresh'><\/span><\/div>"),t.Status===0?(i.HideButton.html(translate.instant("SYSTEM_ACTIONS_LABEL_UNHIDE")),i.toggleClass("private",!0)):t.Status===3&&i.toggleClass("deleted",!0),i.showReply=function(t){var e,u;if(r&&r.cancelEdit(),t===undefined&&(t=!0),f==i.ReplyBox){if(t)return;f=null}i.ReplyBox.toggleClass("hide",!1).toggle(t);t?(f&&f!==i.ReplyBox&&(n.hideReply&&(e=f.Editor,n.hideReply(e),u=e.View,u.ReplySaveButton&&(u.ReplySaveButton.remove(),u.ReplySaveButton=null)),f.toggle(!1)),n.showReply&&(n.showReply(i.RepliedCommentContent),i.ReplySaveButton=$("<button class='btn btn-success standard-button reply-post-button'>"+translate.instant("SYSTEM_ACTIONS_LABEL_POST")+"<\/button>"),i.RepliedCommentContent.before(i.ReplySaveButton),i.ReplySaveButton.click(function(){i.postReply()})),f=i.ReplyBox,i.ReplyBox.find(".with-placeholder").focus()):n.hideReply&&(n.hideReply(i.RepliedCommentContent),i.ReplySaveButton&&(i.ReplySaveButton.remove(),i.ReplySaveButton=null,i.ReplySaveButton=null))},i.edit=function(){r&&r.cancelEdit();i.OriginalComment=i.CommentContent.html();i.toggleClass("is-editing",!0);n.beginEdit?(n.beginEdit(i,t),i.SaveButton.show()):(i.CommentContent.attr("contenteditable",!0),i.CommentContent.focus());i.EditButton.html(translate.instant("SYSTEM_ACTIONS_LABEL_CANCEL"));i.showReply(!1);r=i},i.cancelEdit=function(){i.showCommentMessage("");i.toggleClass("is-editing",!1);var u=!n.cancelEdit||!n.cancelEdit(i,t);u&&(i.CommentContent.removeAttr("contenteditable"),i.CommentContent.html(i.OriginalComment));i.EditButton.html(translate.instant("SYSTEM_ACTIONS_LABEL_EDIT"));i.SaveButton.hide();r=null},i.endEdit=function(u){i.toggleClass("is-editing",!1);n.endEdit?(n.endEdit(i,t),u!==undefined&&i.CommentContent.html(u)):i.CommentContent.removeAttr("contenteditable");i.EditButton.html(translate.instant("SYSTEM_ACTIONS_LABEL_EDIT"));i.SaveButton.hide();r=null},i.hideComment=function(){PKLService.post({api:n.toggleCommentUri,data:{commentId:t.CommentId,shown:!1},OnSuccess:function(){t.Status=0;i.toggleClass("private",!0);i.HideButton.html(translate.instant("SYSTEM_ACTIONS_LABEL_UNHIDE"))},isShowLoading:!1})},i.showComment=function(){PKLService.post({api:n.toggleCommentUri,data:{commentId:t.CommentId,shown:!0},OnSuccess:function(){t.Status=1;i.toggleClass("private",!1);i.HideButton.html(translate.instant("COMMENTS_ACTION_LABEL_HIDE"))},isShowLoading:!1})},i.deleteComment=function(){PKLService.post({api:n.deleteCommentUri,data:{commentId:t.CommentId},OnSuccess:function(){pt&&s!==t.Creator?i.toggleClass("deleted",!0).addClass("hide"):i.slideUp(0,function(){i.remove();ft(-1-t.TotalRepliesCount)})},isShowLoading:!1})},i.saveComment=function(){var t=i.validate(!0),r;t&&(r=t.OriginalText,t.OriginalText=undefined,PKLService.post({api:n.postCommentUri,data:t,OnSuccess:function(){i.endEdit(r)},isShowLoading:!1}))},i.postReply=function(){var n=i.validate();n&&(dt(i),ni(n,function(n){var t=i.Parent||i;t.find(".comment-main > .replies").first().append(n);n.Parent=t;i.showReply(!1);ft();i.RepliedCommentContent.html("")}).always(function(){gt(i)}))},i.expandComment=function(){i.find(".comment-main > .comment-content").last().toggleClass("overflown",!1)},i.toggleWaitingIndicator=function(n){i.find(".comment-main > .reply-box").toggleClass("waiting",n)},i.ViewMoreRepliesButton.click(function(){var n=$(this);n.is(".loading")||(n.toggleClass("loading",!0),l().always(function(){n.toggleClass("loading",!1)}))}),l=function(){return e=e||0,i.loadReplies(e+1).done(function(n){e++;o+=n.loadedCount;i.RepliesContainer.toggleClass("loaded-all",o>=n.total)})},i.loadReplies=function(r){var u=$.Deferred(),f={ContentId:n.contentId,TopLevelCommentId:t.CommentId,OrderedByCreatedTime:!0,PageIndex:r||(n.commentsPerEachLoad>0?0:-1),ItemsPerPage:n.commentsPerEachLoad};return r||(i.RepliesContainer.append(i.ViewMoreRepliesButton),i.ViewMoreRepliesButton.toggleClass("loading",!0)),PKLService.get({api:n.loadCommentsUri,data:f,OnSuccess:function(n){var e=n.Data.comments.map(function(n){var t=new k(n);return t.Parent=i,t}),r={total:t.TotalRepliesCount,loadedCount:n.Data.comments.length};f.PageIndex||(o=r.loadedCount,r.total<=r.loadedCount&&i.RepliesContainer.toggleClass("loaded-all",!0),i.RepliesContainer.children().each(function(){this!=i.ViewMoreRepliesButton[0]&&$(this).remove()}),i.ViewMoreRepliesButton.toggleClass("loading",!1));i.ViewMoreRepliesButton.before(e);u.resolve(r);i.AreRepliesLoaded=!0},OnError:function(n){u.reject(n);r||i.ViewMoreRepliesButton.toggleClass("loading",!1)},isShowLoading:!1}),u.promise()},i.showCommentMessage=function(n,t){var r=i.is(".is-editing")?i.find(".comment-main > .comment-message.for-edit").first():i.find(".comment-main > .comment-message").last();r.html(n);r.toggleClass("error",t)},i.clearCommentMessage=function(){var n=i.is(".is-editing")?i.find(".comment-main > .comment-message.for-edit").first():i.find(".comment-main > .comment-message").last();n.html("")},i.getCommentText=function(n){return(n?i.CommentContent:i.RepliedCommentContent).text()},i.getCommentHtml=function(n){return(n?i.CommentContent:i.RepliedCommentContent).trimmedHtml()},i.validate=function(r){var e="",s=n.getCommentText?n.getCommentText(r?i:i.RepliedCommentContent,r):i.getCommentText(r),u=n.getCommentHtml?n.getCommentHtml(r?i:i.RepliedCommentContent,r):i.getCommentHtml(r),o=u,f;return(it&&(u=encodeURI(u),u=btoa(u)),e=h(s,!1,o),e)?(i.showCommentMessage(e,!0),null):(i.showCommentMessage(e),f={CommentId:t.CommentId,Comment:u,OnContentId:n.contentId,OriginalText:o},r||(f.CommentId=0,f.ToCommentId=t.CommentId,f.TopLevelCommentId=t.TopLevelCommentId||t.CommentId),f)},i.SaveButton.click(function(){i.saveComment()}),i.LikeComment=function(){if(s!=null&&s!=""){var u=$("#img_"+t.CommentId),r={PostId:t.CommentId,IsUp:!1,IsDelete:!1};u.hasClass("cl-icon-thumbs-up-full")?($("#img_"+t.CommentId).removeAttr("class").addClass("cl-icon-thumbs-up-1"),r.IsUp=!0,r.IsDelete=!0):($("#img_"+t.CommentId).removeAttr("class").addClass("cl-icon-thumbs-up-full"),$("#imgDisLike_"+t.CommentId).removeAttr("class").addClass("cl-icon-thumbs-down-1"),r.IsUp=!0,r.IsDelete=!1);$.post(n.postLikeCommentUri,r,function(n){if(n.Errors.length>0){var r=translate.instant(n.Errors[0].message);console.log(r);i.showCommentMessage(r,!0)}$("#countVoteLike_"+t.CommentId).text(" "+n.Data.TotalLikePost);$("#countVoteDisLike_"+t.CommentId).text(" "+n.Data.TotalDisLikePost)})}},i.DisLikeComment=function(){if(s!=null&&s!=""){var u=$("#imgDisLike_"+t.CommentId),r={PostId:t.CommentId,IsUp:!1,IsDelete:!1};u.hasClass("cl-icon-thumbs-down-full")?($("#imgDisLike_"+t.CommentId).removeAttr("class").addClass("cl-icon-thumbs-down-1"),r.IsUp=!1,r.IsDelete=!0):($("#imgDisLike_"+t.CommentId).removeAttr("class").addClass("cl-icon-thumbs-down-full"),$("#img_"+t.CommentId).removeAttr("class").addClass("cl-icon-thumbs-up-1"),r.IsUp=!1,r.IsDelete=!1);$.post(n.postLikeCommentUri,r,function(n){if(n.Errors.length>0){var r=translate.instant(n.Errors[0].message);console.log(r);i.showCommentMessage(r,!0)}$("#countVoteLike_"+t.CommentId).text(" "+n.Data.TotalLikePost);$("#countVoteDisLike_"+t.CommentId).text(" "+n.Data.TotalDisLikePost)})}},i.ReplyButton.click(function(){i.showReply()}),i.find(".comment-main > .view-more").last().click(function(){i.expandComment()}),i.RepliedCommentContent.keydown(function(n){n.keyCode!==13||n.shiftKey||n.preventDefault()}).keyup(function(n){n.keyCode!==13||n.shiftKey||i.postReply()}).simulateOnChange(function(){var n=h($(this).text(),!0);i.showCommentMessage(n,!!n)}),i.PostReplyButton.click(function(n){n.preventDefault();i.postReply()}),i.AreRepliesExpanded=!1,i.HideButton.click(function(){i.is(".private")?i.showComment():i.hideComment()}),i.EditButton.click(function(){i.is(".is-editing")?i.cancelEdit():i.edit()}),i.DeleteButton.click(function(){modal.confirm({content:translate.instant("COMMENTS_MESSAGE_CONFIRM_DELETE"),OnSuccess:function(){i.deleteComment()}})}),i.CommentContent.keydown(function(n){n.keyCode===13&&i.is(".is-editing")&&(n.shiftKey||n.preventDefault())}).keyup(function(n){n.keyCode===13&&i.is(".is-editing")&&(n.shiftKey||i.saveComment())}).simulateOnChange(function(){var n=h($(this).text(),!0);i.showCommentMessage(n,!!n)}),i.LikeButton.click(function(){i.LikeComment()}),i.DisLikeButton.click(function(){i.DisLikeComment()}),i.find(".comment-main > .comment-footer > .left-parts > .toggle-replies").last().click(function(n){var t=i.find(".comment-main > .replies");i.AreRepliesExpanded=!i.AreRepliesExpanded;t.toggle(i.AreRepliesExpanded);i.AreRepliesLoaded||i.loadReplies();$(n.target).html(i.AreRepliesExpanded?translate.instant("COMMENT_ACTION_LABEL_HIDE_REPLY"):translate.instant("COMMENTS_ACTION_LABEL_VIEW_REPLIES"))}),i.ExpandMoreRepliesButton.click(function(){i.loadReplies()}),t.Replies&&t.Replies[0]&&t.TotalRepliesCount===1&&(c=new k(t.Replies[0]),c.Parent=i,i.RepliesContainer.append(c)),i}function ei(n){var t={vn:"vi-VN",en:"en-US"}[LANG_CURRENT];return t===undefined&&(t="en-US"),new Intl.DateTimeFormat(t,{year:"numeric",month:"short",day:"numeric"}).format(n)}function dt(n){n.toggleWaitingIndicator&&n.toggleWaitingIndicator(!0)}function gt(n){n.toggleWaitingIndicator&&n.toggleWaitingIndicator(!1)}function ni(t,i){if(nt)return{};nt=!0;return PKLService.post({api:n.postCommentUri,data:t,OnSuccess:function(n){var t=new k(n.Data);i(t)},isShowLoading:!1}).always(function(){nt=!1})}function d(i,u){var f,o,s,e,c;if(r&&r.cancelEdit(),f=i?i():$("#comment-box").trimmedHtml(),o=f,it&&(f=encodeURI(f),f=btoa(f)),s=u?u():$("#comment-box").text(),e=h(s,!1,o),e){$("#top-comment-message").html(e).toggleClass("error",!0);return}$("#top-comment-message").html("");c={Comment:f,OnContentId:n.contentId};dt(t);ni(c,function(i){var r=at.length?at:t;r.after(i);$("#comment-box").text("");ft();n.onClearTopLevelInput&&n.onClearTopLevelInput()}).always(function(){gt(t)})}function ti(n,t){var i=h(n,!0,t);$("#top-comment-message").html(i).toggleClass("error",!!i)}function oi(){$("#add-comment-button").click(d);$(document).on("click",".top-level-comment-input .submit-cmmt",function(n){n.preventDefault();d()});$("#comment-box").keydown(function(n){n.keyCode!=13||n.shiftKey||n.preventDefault()}).keyup(function(n){n.keyCode!=13||n.shiftKey||d()}).simulateOnChange(function(){ti($(this).text())})}function ft(n){n=n||1;i+=n;$("#total-comments").html(i);e.html(i);t.toggleClass("with-no-comment",i<=0)}function g(r,f){var s,h;return(u=$(n.containerSelector),s=$.Deferred(),b)?(s.reject("invalid_operation"),s.promise()):n.isValid()?(h=function(){var o=$.Deferred(),h=r===undefined||r<=0,s={ContentId:n.contentId,TopLevelCommentId:r,PageIndex:f||(n.commentsPerEachLoad>0?0:-1),ItemsPerPage:n.commentsPerEachLoad};return f||(u.html("").append(w),c.toggleClass("loading",!0)),b=!0,PKLService.get({api:n.loadCommentsUri,data:s,OnSuccess:function(r){var l,h,f,a;if(setTimeout(function(){b=!1},1e3),l=r.Data.comments.map(function(n){return new k(n)}),i=r.Data.total,vt=n.renderTopCounts({totalCommentsCount:i}),tt?t.length==0&&(t=$(n.renderTopLevelInputHtml(rt)),i==0&&t.toggleClass("with-no-comment",!0),t.toggleWaitingIndicator=function(n){t.find(".comment-box").toggleClass("waiting",n);$("#add-comment-button").toggleClass("waiting",n)}):(h="<div class='permission-required-msg comment-message error'>"+translate.instant(bt)+"<\/div>",typeof isNotAuthen!="undefined"&&isNotAuthen==!0&&(h=""),t=$(h)),f={total:r.Data.totalTopComments,loadedCount:r.Data.comments.length},o.resolve(f),e.html(i),!s.PageIndex){ut=f.loadedCount;a=[vt,t];u.toggleClass("loaded-all",f.loadedCount>=f.total);w.before(a);c.toggleClass("loading",!1);c.off("click").on("click",kt)}w.before(l);oi();checkVerScrollBarDisplay()},OnError:function(n){setTimeout(function(){b=!1},1e3);o.reject(n);f||c.toggleClass("loading",!1)},isShowLoading:!1}),o.promise()},o?(et().done(function(){h().done(function(n){s.resolve(n)}).fail(function(n){s.reject(n)})}),s.promise()):h()):(s.reject(),s.promise())}function si(n){return p==undefined&&(p=0),g(n,p+1).done(function(n){p++;ut+=n.loadedCount;u.toggleClass("loaded-all",ut>=n.total)})}function hi(t){n.contentId=t;o=!0}function ci(t){pt=t.IsCurrentUserAdminOrMod;tt=t.CanCurrentUserUseComment;bt=t.PermissionRequiredMessage;yt=t.CurrentUserAvatarUri;i=t.TotalComments;s=t.CurrentUserName;it=t.EncodeCommentAsBase64;rt.currentUserAvatarUri=yt;rt.currentUserLevelAvatarUri=t.CurrentUserLevelAvatarUri;n.maxCommentLength=t.GeneralCommentMaxLength;e=$(n.headerCountSelector);e.html(i);o=!1;n.endLoadingModuleContext&&n.endLoadingModuleContext(t)}function et(t){return o?n.isValid()?n.loadModuleContextUri?t?{done:function(n){n()}}:PKLService.get({api:n.loadModuleContextUri,data:{contentId:n.contentId},OnSuccess:function(n){ci(n.Data)},isShowLoading:!1}):{}:{}:{}}function ii(t){o=!0;n.trigger&&(n.trigger.loadComments=function(){n.trigger.isLoadCommentsPending=!0},n.trigger.updateHeaderCount=function(){n.trigger.isUpdateHeaderCountPending=!0});et(isNotCountComment).done(function(){var r=c.find(".view-more-text");r.html(translate.instant("COMMENTS_LABEL_VIEW_MORE"));u.length||(u=$(n.containerSelector));(t||!n.trigger)&&g();n.trigger&&(n.trigger.loadComments=g,n.trigger.updateContentId=hi,n.trigger.loadModule=ii,n.trigger.updateHeaderCount=function(){if(o){et();return}e=$(n.headerCountSelector);e.html(i)},n.trigger.postTopLevelComment=d,n.trigger.validateTopLevelCommentInput=ti,n.trigger.isLoadCommentsPending&&(g(),n.trigger.isLoadCommentsPending=undefined),n.trigger.isUpdateHeaderCountPending&&(n.trigger.updateHeaderCount(),n.trigger.isUpdateHeaderCountPending=undefined))})}var l="",a="",v="",y="",ot="",st="",ht="",ct="",lt="",ri=cvUrl,ui={contentId:"",loadCommentsUri:"",initLoad:!1,newCommentAfter:"",topLevelInputSelector:"",get postCommentUri(){return v||(v=this.loadCommentsUri.replace(/\/[^/]+$/,"/PostComment")),v},set postCommentUri(n){v=n},get deleteCommentUri(){return a||(a=this.loadCommentsUri.replace(/\/[^/]+$/,"/DeleteComment")),a},set deleteCommentUri(n){a=n},get toggleCommentUri(){return y||(y=this.loadCommentsUri.replace(/\/[^/]+$/,"/ToggleCommentVisibility")),y},set toggleCommentUri(n){y=n},get loadModuleContextUri(){return l||(l=this.loadCommentsUri.replace(/\/[^/]+$/,"/LoadCommentModuleContext")),l},set loadModuleContextUri(n){l=n},get postUpVoteCommentUri(){return ot},set postUpVoteCommentUri(n){ot=n},get postDownVoteCommentUri(){return st},set postDownVoteCommentUri(n){st=n},get postLikeCommentUri(){return ht},set postLikeCommentUri(n){ht=n},get getAllVotePostUri(){return ct},set getAllVotePostUri(n){ct=n},get getUserVotePostUri(){return lt},set getUserVotePostUri(n){lt=n},containerSelector:"",headerCountSelector:"",minCommentLength:1,maxCommentLength:300,trigger:null,commentsPerEachLoad:10,isValid:function(){var n=this.loadCommentsUri&&this.postCommentUri&&this.toggleCommentUri&&this.containerSelector;return n||console.log("WARNING: Invalid options to initialize the Comment Module, please check the options again"),n},renderTopLevelInputHtml:function(n){var t=translate.instant("COMMENTS_MESSAGE_WRITE_COMMENT");return'<div class="top-level-comment-input">                             <div class="user-avatar">                                 <div class="avatars">                                     <img class="level-avatar" src="'+s3Storage+n.currentUserLevelAvatarUri+'"/>                                     <img src="'+s3Storage+n.currentUserAvatarUri+'"/>                                 <\/div>                             <\/div>                             <div class="edit-box comment-box">                                 <div placeholder="'+translate.instant("COMMENTS_PLACEHOLDER_WRITE")+'" class="with-placeholder" id="comment-box" contenteditable><\/div>                                 <div class="waiting-indicator"><span class="glyphicon glyphicon-refresh"><\/span><\/div>                                 <div class="comment-message" id="top-comment-message"><\/div>                                 <a href="#" class="submit-cmmt btn" title="'+translate.instant("COMMENTS_ACTION_LABEL_COMMENT")+'">'+translate.instant("COMMENTS_ACTION_LABEL_COMMENT")+"<\/a>                            <\/div>                     <\/div>"},renderTopCounts:function(n){var t="";return typeof isNotAuthen!="undefined"&&isNotAuthen==!0&&(t='<a href="javascript:void(0)" data-toggle="modal" data-target="#loginModal" onclick="openModal("login")" id="not-auth" style="display: inline-block; color:red; margin: 10px 0px; font-style: italic">'+translate.instant("COMMENTS_MESSAGE_SIGNIN")+"<\/a>"),$(t+"<div class='total-comments-section'><span id='total-comments'>"+n.totalCommentsCount+"<\/span> "+translate.instant("COMMENTS_LABEL")+"<\/div>")},onClearTopLevelInput:null,endLoadingModuleContext:null,beginEdit:null,cancelEdit:null,endEdit:null,showReply:null,hideReply:null,getCommentText:null,getCommentHtml:null},h,kt,fi;n=$.extend(ui,n);var t=$(n.topLevelInputSelector),at=$(n.newCommentAfter),vt,i,f,r,u=$(n.containerSelector),e=$(n.headerCountSelector),o=!0,nt,yt,pt,wt='<span class="big-dot">&#x25cf;<\/span>',tt,bt,s,it,rt={},p=0,ut=0,li=$("<div class='comments-loading'><span class='glyphicon glyphicon-refresh'><\/span><\/div>"),w=$("<div class='view-more-comments-button-container'><div class='view-more-comments-button btn btn-default'><span class='view-more-text'><\/span><span class='glyphicon glyphicon-refresh'><\/span><\/div><\/div>"),c=w.find(".view-more-comments-button"),b=!1;$.fn.simulateOnChange=function(n){var t=this.each(function(){var n=$(this),t=n.html();n.focus(function(){t=n.html()});n.on("keyup mouseup cut paste copy",function(){setTimeout(function(){var i=n.html();i!==t&&(n.trigger("change"),t=i)},0)})});if(n)this.on("change",n);return t};h=function(t,i,r){i=i||!1;var f=r&&r.toLowerCase().includes("<img"),u="";return(!t||t.length<n.minCommentLength)&&!f&&(u=translate.instant("COMMENTS_MESSAGE_REQUIRED_MIN_INPUT").replace("{0}",n.minCommentLength)),i||t.trim()!==""||f||(u=translate.instant("COMMENTS_MESSAGE_INVALID")),t.length>n.maxCommentLength&&(u=translate.instant("COMMENTS_MESSAGE_REQUIRED_MAX_INPUT").replace("{0}",n.maxCommentLength)),u};kt=function(){var n=$(this);n.is(".loading")||(n.toggleClass("loading",!0),si().always(function(){n.toggleClass("loading",!1)}))};fi={};ii(n.initLoad)};